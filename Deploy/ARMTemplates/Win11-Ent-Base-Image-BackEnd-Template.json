
{
    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {},
    "variables": {},
    "resources": [
        {
            "type": "Microsoft.VirtualMachineImages/imageTemplates",
            "apiVersion": "2022-02-14",
            "dependsOn": [],
            "name": "<imageName>",
            "location": "<region>",
            "properties": {
                "buildTimeoutInMinutes": 120,
                "vmProfile": {
                    "vmSize": "Standard_D8s_v3",
                    "osDiskSizeGB": 128,
                    "osDisk": {
                        "osType": "Windows",
                        "name": "osdisk1",
                        "caching": "ReadWrite",
                        "createOption": "FromImage",
                        "diffDiskSettings": {
                            "option": "Local"
                        },
                        "diskSizeGB": 128,
                        "managedDisk": {
                            "storageAccountType": "Premium_LRS"
                        }
                    },
                    "dataDisks": [
                        {
                            "name": "datadisk1",
                            "diskSizeGB": 1023,
                            "lun": 0,
                            "createOption": "Empty",
                            "sku": {
                                "name": "Premium_LRS"
                            }
                        }
                    ]
                },
                "source": {
                    "type": "PlatformImage",
                    "publisher": "microsoftvisualstudio",
                    "offer": "visualstudioplustools",
                    "sku": "vs-2022-ent-general-win11-m365-gen2",
                    "version": "latest"
                },
                "distribute": [
                    {
                        "type": "SharedImage",
                        "galleryImageId": "/subscriptions/<subscriptionID>/resourceGroups/<rgName>/providers/Microsoft.Compute/galleries/<sharedImageGalName>/images/<imageName>",
                        "runOutputName": "<imageName>",
                        "replicationRegions": []
                    }
                ]
            },
            "tags": {
                "division": "IT",
                "Environment": "Dev-Workstation",
                "Role": "Back-End-Engineer"
            },
            "identity": {
                "type": "UserAssigned",
                "userAssignedIdentities": {
                    "/subscriptions/<subscriptionID>/resourceGroups/<rgName>/providers/Microsoft.ManagedIdentity/userAssignedIdentities/<identityName>": {}
                }
            }
        }
    ]
}
